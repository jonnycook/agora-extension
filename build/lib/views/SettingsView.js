// Generated by CoffeeScript 1.7.1
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define(['View', 'Site', 'Formatter', 'util', 'underscore'], function(View, Site, Formatter, util, _) {
  var SettingsView;
  return SettingsView = (function(_super) {
    __extends(SettingsView, _super);

    function SettingsView() {
      return SettingsView.__super__.constructor.apply(this, arguments);
    }

    SettingsView.nextId = 0;

    SettingsView.id = function(args) {
      return ++this.nextId;
    };

    SettingsView.prototype.initAsync = function(args, done) {
      return this.background.getStorage(['options'], (function(_this) {
        return function(data) {
          var _ref, _ref1, _ref2, _ref3, _ref4, _ref5;
          _this.data = {
            hideBelt: (_ref = (_ref1 = data.options) != null ? _ref1.hideBelt : void 0) != null ? _ref : false,
            autoFeelings: (_ref2 = (_ref3 = data.options) != null ? _ref3.autoFeelings : void 0) != null ? _ref2 : false,
            showPreview: (_ref4 = (_ref5 = data.options) != null ? _ref5.showPreview : void 0) != null ? _ref4 : false
          };
          return done();
        };
      })(this));
    };

    SettingsView.client = function() {
      return SettingsView = (function(_super1) {
        __extends(SettingsView, _super1);

        function SettingsView() {
          return SettingsView.__super__.constructor.apply(this, arguments);
        }

        SettingsView.prototype.type = 'Settings';

        SettingsView.prototype.booleanSettings = ['hideBelt', 'autoFeelings', 'showPreview'];

        SettingsView.prototype.init = function() {
          var name, _i, _len, _ref, _results;
          this.viewEl('<div class="v-settings t-dialog"> <h2>Settings</h2> <div class="content"> <form> <div class="field"><input type="checkbox" name="hideBelt"> <label>Hide Belt</label></div> <div class="field"><input type="checkbox" name="autoFeelings"> <label>Auto Feelings</label></div> <div class="field"><input type="checkbox" name="showPreview"> <label>Show Preview</label></div> <!--<input type="Submit">--> </form> </div> </div>');
          _ref = this.booleanSettings;
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            name = _ref[_i];
            _results.push((function(_this) {
              return function(name) {
                return _this.el.find("[name=" + name + "]").change(function() {
                  return _this.callBackgroundMethod('update', [name, _this.el.find("[name=" + name + "]").prop('checked')]);
                });
              };
            })(this)(name));
          }
          return _results;
        };

        SettingsView.prototype.onData = function(data) {
          var name, _i, _len, _ref, _results;
          _ref = this.booleanSettings;
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            name = _ref[_i];
            if (data[name]) {
              _results.push(this.el.find("[name=" + name + "]").prop('checked', true));
            } else {
              _results.push(void 0);
            }
          }
          return _results;
        };

        return SettingsView;

      })(View);
    };

    SettingsView.prototype.methods = {
      submit: function(view, subject, message) {
        return this.agora.background.httpRequest("" + this.agora.background.apiRoot + "contact.php", {
          method: 'post',
          data: {
            subject: subject,
            message: message
          }
        });
      },
      update: function(view, prop, value) {
        var options;
        options = {};
        options[prop] = value;
        return this.agora.setOptions(options);
      }
    };

    return SettingsView;

  })(View);
});

//# sourceMappingURL=SettingsView.map
