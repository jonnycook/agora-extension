// Generated by CoffeeScript 1.7.1
define(function() {
  var maintainOrder;
  return maintainOrder = function(orderBy, instance, list) {
    var compare, order, ordering;
    compare = (function(_this) {
      return function(a, b) {
        var result;
        if (a.get(orderBy.field) < b.get(orderBy.field)) {
          result = -1;
        } else if (a.get(orderBy.field) > b.get(orderBy.field)) {
          result = 1;
        } else {
          result = 0;
        }
        if (orderBy.direction === 'desc') {
          result *= -1;
        }
        return result;
      };
    })(this);
    list.sort(compare);
    ordering = false;
    order = function() {
      var i, index, result, to, _i, _j, _ref, _ref1;
      if (ordering) {
        return;
      }
      ordering = true;
      index = list.indexOf(instance);
      to = null;
      for (i = _i = 0, _ref = list.length() - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
        if (instance === list.get(i)) {
          continue;
        }
        result = compare(instance, list.get(i));
        if (result < 0) {
          to = index > i ? i : i - 1;
          break;
        } else if (result === 0) {
          return;
        }
      }
      if (to === null) {
        to = list.length() - 1;
      }
      list.move(index, to);
      for (i = _j = 0, _ref1 = list.length() - 1; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; i = 0 <= _ref1 ? ++_j : --_j) {
        list.get(i).set(orderBy.field, i);
      }
      return ordering = false;
    };
    instance.field(orderBy.field).observe(order);
    return function() {
      return instance.field(orderBy.field).stopObserving(order);
    };
  };
});

//# sourceMappingURL=maintainOrder.map
