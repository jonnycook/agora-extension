// Generated by CoffeeScript 1.7.1
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define(function() {
  return {
    d: ['View', 'util', 'icons'],
    c: function() {
      var SocialShareView;
      return SocialShareView = (function(_super) {
        __extends(SocialShareView, _super);

        SocialShareView.prototype.type = 'SocialShare';

        function SocialShareView() {
          SocialShareView.__super__.constructor.apply(this, arguments);
          this.viewEl('<div class="v-socialShare t-dialog"> <h2>Share Decision</h2> <div class="content"> <ul class="services"> <li class="twitter"></li> <li class="facebook"> <iframe></iframe> </li> <li class="googlePlus"></li> </ul> <input type="text" class="url"> <select class="access"> <option value="0">Private</option> <option value="1">Public (Unlisted)</option> <option value="2">Public (Listed)</option> </select> </div> </div>');
          this.el.find('.url').focus(function() {
            return this.select();
          });
          this.el.find('.url').mouseup(false);
          this.el.find('.twitter').click((function(_this) {
            return function() {
              if (_this.el.hasClass('private')) {
                return;
              }
              tracking.event('SocialShare', 'Twitter');
              return window.open("https://twitter.com/share?url=" + (escape(_this.url)), null, 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=500,height=260');
            };
          })(this));
          this.el.find('.googlePlus').click((function(_this) {
            return function() {
              if (_this.el.hasClass('private')) {
                return;
              }
              tracking.event('SocialShare', 'Google+');
              return window.open("https://plus.google.com/share?url=" + _this.url, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,height=420,width=510');
            };
          })(this));
          this.el.find('.access').change((function(_this) {
            return function() {
              return _this.callBackgroundMethod('setAccess', _this.el.find('.access').val());
            };
          })(this));
          util.styleSelect(this.el.find('.access'), {
            "class": 'access',
            label: false,
            autoSize: false
          });
        }

        SocialShareView.prototype.onData = function(data) {
          this.url = data.url;
          this.el.find('.facebook iframe').attr('src', "//agora.sh/facebookShare.php?url=" + this.url);
          if (data.owner) {
            this.el.addClass('owner');
            if (typeof this.sizeChanged === "function") {
              this.sizeChanged();
            }
          }
          this.el.find('.url').val(data.url);
          return this.withData(data.access, (function(_this) {
            return function(access) {
              if (access === 0) {
                _this.el.addClass('private');
                _this.el.find('.url').prop('disabled', true);
              } else {
                _this.el.removeClass('private');
                _this.el.find('.url').prop('disabled', false);
              }
              _this.el.find('.access').prop('selectedIndex', access);
              return _this.el.find('.access').trigger('change');
            };
          })(this));
        };

        return SocialShareView;

      })(View);
    }
  };
});

//# sourceMappingURL=SocialShareView.map
