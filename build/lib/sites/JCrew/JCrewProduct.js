// Generated by CoffeeScript 1.7.1
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define(['scraping/SiteProduct', 'util'], function(SiteProduct, util) {
  var JCrewProduct;
  return JCrewProduct = (function(_super) {
    __extends(JCrewProduct, _super);

    function JCrewProduct() {
      return JCrewProduct.__super__.constructor.apply(this, arguments);
    }

    JCrewProduct.prototype.variantImage = function(variant, cb) {
      return this.product["with"]('more', (function(_this) {
        return function(more) {
          var _ref;
          if (more) {
            return cb((_ref = more.colorImages) != null ? _ref[variant.Color] : void 0);
          } else {
            return cb();
          }
        };
      })(this));
    };

    JCrewProduct.prototype.images = function(cb) {
      return this.product["with"]('more', (function(_this) {
        return function(more) {
          var images, otherImages;
          if (more) {
            otherImages = _.map(more.images, function(image) {
              return {
                small: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=10',
                medim: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=6',
                large: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=3',
                larger: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=2',
                full: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=1'
              };
            });
            images = _.mapValues(more.colorImages, function(image) {
              return [
                {
                  small: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=10',
                  medium: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=6',
                  large: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=3',
                  larger: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=2',
                  full: image.match(/^([^?]*)/)[1] + '?fmt=jpeg&op_sharpen=0&resMode=sharp2&scl=1'
                }
              ].concat(otherImages);
            });
            return cb(images, more.color);
          } else {
            return cb();
          }
        };
      })(this));
    };

    JCrewProduct.prototype.widgets = function(cb) {
      return this.product["with"]('more', 'reviews', (function(_this) {
        return function(more, reviews) {
          var widgets;
          widgets = _this.genWidgets(more, {
            description: 'Description',
            sizes: 'Sizes',
            colors: {
              title: 'Colors',
              map: function(color) {
                return util.ucfirst(color.name);
              }
            },
            reviews: {
              obj: reviews
            }
          });
          return cb(widgets);
        };
      })(this));
    };

    return JCrewProduct;

  })(SiteProduct);
});

//# sourceMappingURL=JCrewProduct.map
